name       : tlp
version    : 0.9
release    : 5
source     :
    - https://github.com/linrunner/TLP/archive/0.9.tar.gz : 887b226d443f930398fda5793ac690e1e1ef7dd2187db7be0278359315aa7a76
license    : GPL-2.0
component  : system.utils
summary    : Linux Advanced Power Management
description: |
    Linux Advanced Power Management
builddeps  :
    - hdparm
    - iw
    - rfkill
rundeps    :
    - rfkill
setup      : |
    # Disable USB Autosuspend
    sed -i 's:USB_AUTOSUSPEND=1:USB_AUTOSUSPEND=0:g' default
build      : |
    export TLP_LIBDIR='%libdir%'
    export TLP_SBIN='/usr/sbin'
    export TLP_ULIB='%libdir%/udev/'
    %make
install    : |
    export TLP_NO_INIT='1'
    export TLP_SYSD='%libdir%/systemd/system/'
    export TLP_WITH_SYSTEMD='1'
    %make_install
    mkdir -p $installdir/%libdir%
    mv $installdir/lib/udev $installdir/%libdir%/
    mv $installdir/usr/lib/* $installdir/%libdir%/
    rm -rf $installdir/lib $installdir/usr/lib

    # Enable by default, users can disable now with systemctl mask tlp
    install -D -d -m 00755 $installdir/%libdir%/systemd/system/multi-user.target.wants
    ln -sv ../tlp.service $installdir/%libdir%/systemd/system/multi-user.target.wants
